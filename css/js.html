<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
 $(document).ready(function () {
  $('#pageRegister').hide();

  window.openPageRegister = function () {
    $('#pagelogin').hide();
    $('#pageRegister').show();
  }

  window.openPagelogin = function () {
    $('#pagelogin').show();
    $('#pageRegister').hide();
  }

  $('#registerForm').submit(function (event) {
    event.preventDefault();
    const username = $('#registerUsername').val().trim();
    const phone = $('#registerPhone').val().trim();
    const password = $('#registerPassword').val().trim();

    if (!username || !phone || !password) {
      Swal.fire('ผิดพลาด', 'กรุณากรอกข้อมูลให้ครบถ้วน', 'warning');
      return;
    }

    if (!/^\d{9,}$/.test(phone)) {
      Swal.fire('ผิดพลาด', 'เบอร์โทรศัพท์ต้องเป็นตัวเลขอย่างน้อย 9 หลัก', 'error');
      return;
    }

    Swal.fire({
      title: 'กำลังลงทะเบียน...',
      allowOutsideClick: false,
      didOpen: () => Swal.showLoading()
    });

    setTimeout(() => {
      Swal.fire('ลงทะเบียนสำเร็จ', '', 'success');
      openPagelogin();
    }, 1500);
  });

  $('#loginForm').submit(function (event) {
    event.preventDefault();
    const username = $('#inputusername').val().trim();
    const password = $('#inputpassword').val().trim();

    if (!username || !password) {
      Swal.fire('ผิดพลาด', 'กรุณากรอกชื่อผู้ใช้และรหัสผ่าน', 'warning');
      return;
    }

    // จำลองการ login สำเร็จ
    Swal.fire({
      title: 'กำลังเข้าสู่ระบบ...',
      allowOutsideClick: false,
      didOpen: () => Swal.showLoading()
    });

    setTimeout(() => {
      window.location.href = "page10.html";
    }, 1500);
  });
});
function validateLoginForm() {
  const username = document.getElementById("inputusername").value.trim();
  const password = document.getElementById("inputpassword").value.trim();

  if (!username || !password) {
    alert("กรุณากรอกชื่อผู้ใช้และรหัสผ่านให้ครบ");
    return false;
  }

  // ถ้า login สำเร็จ
  goToPage10();
  return false; // ป้องกัน form รีเฟรช
}
function goToPage10() {
  window.location.href = "page10.html";
}
</script>
<script>
  function hideAllPages() {
    $("#pagelogin, #pageRegister, #page10, #page11, #page12").hide();
    $(".gradient-custom-2").hide(); // ซ่อน gradient background
    
  }

  function goToPage10() {
    hideAllPages();
    $("#page10").show();
  }
  function goToPage11() {
  hideAllPages();
  $("#page11").removeClass("d-none").show();
}

</script>
<!-- ------------------------ -->
<!-- ตัวแปรเก็บข้อมูลแบบประเมิน ตัวอย่างคำถาม -->
<!-- ------------------------ -->
<script>
const questions = [
  "1. คุณรู้สึกเครียดหรือวิตกกังวลบ่อยแค่ไหน?",
  "2. คุณรู้สึกหมดแรง ไม่มีแรงทำอะไรหรือไม่?",
  "3. คุณนอนหลับได้ดีหรือไม่ในช่วงที่ผ่านมา?",
  "4. คุณรู้สึกไม่มีความสุขกับชีวิตบ่อยแค่ไหน?",
  "5. คุณรู้สึกหงุดหงิดหรือโมโหง่ายหรือไม่?",
];

function showPage(pageId) {
  const pages = ['pageLogin', 'pageRegister', 'page10', 'page11', 'page12', 'page13', 'page14'];
  pages.forEach(id => {
    const el = document.getElementById(id);
    if (!el) return;
    el.style.display = (id === pageId) ? 'block' : 'none';
  });
}

showPage('pageLogin');

// สลับหน้า Login/Register
document.getElementById('goToRegister').addEventListener('click', e => {
  e.preventDefault();
  showPage('pageRegister');
});
document.getElementById('goToLogin').addEventListener('click', e => {
  e.preventDefault();
  showPage('pageLogin');
});

// Login
document.getElementById('loginForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const username = document.getElementById('loginUsername').value.trim();
  const password = document.getElementById('loginPassword').value.trim();

  if (username === "" || password === "") {
    Swal.fire('ผิดพลาด', 'กรุณากรอกชื่อผู้ใช้และรหัสผ่านให้ครบ', 'error');
    return;
  }

  Swal.fire({
    icon: 'success',
    title: 'เข้าสู่ระบบสำเร็จ',
    showConfirmButton: false,
    timer: 1200
  }).then(() => {
    showPage('page10');
  });
});

// Register
document.getElementById('registerForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const username = document.getElementById('registerUsername').value.trim();
  const phone = document.getElementById('registerPhone').value.trim();
  const password = document.getElementById('registerPassword').value.trim();

  if (username === "" || phone === "" || password === "") {
    Swal.fire('ผิดพลาด', 'กรุณากรอกข้อมูลให้ครบถ้วน', 'error');
    return;
  }

  Swal.fire({
    icon: 'success',
    title: 'สมัครสมาชิกสำเร็จ',
    showConfirmButton: false,
    timer: 1200
  }).then(() => {
    showPage('pageLogin');
  });
});

// ไปหน้าแบบประเมิน
document.getElementById('startAssessmentBtn').addEventListener('click', () => {
  renderAssessmentForm();
  showPage('page11');
});

// สร้างฟอร์มแบบประเมิน
function renderAssessmentForm() {
  let html = "";
  for (let i = 0; i < questions.length; i++) {
    html += `
      <div class="assessment-question">
        <label class="form-label">${questions[i]}</label>
        <div class="scale-labels" style="max-width: 500px;">
          <span>น้อย</span><span>มาก</span>
        </div>
        <div class="radio-group-custom">
          ${[...Array(8)].map((_,j)=>`
            <label>
              <input type="radio" name="q${i+1}" value="${j}" required />
              <span class="custom-radio-scale"></span>
              <span class="radio-label">${j}</span>
            </label>
          `).join('')}
        </div>
      </div>
    `;
  }
  html += `<div class="text-center"><button type="submit" class="btn btn-primary btn-lg">ยืนยันผล</button></div>`;
  document.getElementById('assessmentForm').innerHTML = html;
}

// ส่งคำตอบแบบประเมิน
document.getElementById('assessmentForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const answers = [];
  let valid = true;
  for (let i = 1; i <= 5; i++) {
    const val = document.querySelector('input[name="q'+i+'"]:checked');
    if (!val) {
      valid = false;
      break;
    }
    answers.push(parseInt(val.value));
  }
  if (!valid) {
    Swal.fire('กรุณาตอบคำถามให้ครบทุกข้อ', '', 'warning');
    return;
  }
  Swal.fire({
    icon: 'success',
    title: 'ทำแบบประเมินเสร็จสิ้น',
    text: 'ขอบคุณที่ทำแบบประเมิน',
    confirmButtonText: 'ปิด'
  });
  showPage('page12');
});

// Flow หน้า 12 → 13 → 14
document.getElementById('toNextFrom12').addEventListener('click', () => {
  showPage('page13');
});
document.getElementById('toMissionBtn').addEventListener('click', () => {
  showPage('page14');
});

// ระบบปีศาจลด HP + เอฟเฟกต์ + เสียง
let monsterHP = 100;
const monsterImg = document.getElementById('monsterImg');
const hpText = document.getElementById('hpText');
const missionButtons = document.querySelectorAll('.do-btn');
const fxHit = document.getElementById('fxHit');
const fxWin = document.getElementById('fxWin');

const monsterImages = {
  100: "https://i.ibb.co/60CZ3mRt/Chat-GPT-Image-Jun-14-2025-06-53-53-AM-fotor-bg-remover-20250614214120.png",
  80:  "https://i.ibb.co/39VHmcTg/Screenshot-68.png",
  60:  "https://i.ibb.co/3HL4Rcg/Chat-GPT-Image-Jun-13-2025-03-55-23-PM.png",
  40:  "https://i.ibb.co/7d138ZY9/Chat-GPT-Image-Jun-13-2025-03-55-21-PM.png",
  20:  "https://i.ibb.co/60gD414Q/Chat-GPT-Image-Jun-13-2025-03-55-17-PM.png",
  0:   "https://i.ibb.co/1fGNFRFk/Chat-GPT-Image-Jun-13-2025-03-54-34-PM.png"
};

missionButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    if (monsterHP <= 0 || btn.disabled) return;

    btn.disabled = true;
    btn.innerText = '✔ สำเร็จ';

    monsterHP -= 20;
    if (monsterHP < 0) monsterHP = 0;

    fxHit.currentTime = 0;
    fxHit.play();

    monsterImg.classList.add('monster-hit');
    setTimeout(() => {
      monsterImg.classList.remove('monster-hit');
      monsterImg.src = monsterImages[monsterHP];
      hpText.innerText = `พลังชีวิตปีศาจ: ${monsterHP}%`;
    }, 400);

    if (monsterHP === 0) {
      document.getElementById('missionComplete').style.display = 'block';
      fxWin.play();
    }
  });
});
</script>
